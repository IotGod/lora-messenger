<!DOCTYPE html>
<html lang="en">
 <head>
  <title>LoRa Messenger</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
 
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script> 
 </head>

<body>

  <script>
 
  $(document).ready(function() {

     $('#traButton').click(function(){
	     var msg = $("#messageToSend").val();
	     console.log("Transmit message: "+msg);

	     $.post("/transmit", {'message': msg} )		
     });

    function doReceive(){

	     var dt = new Date($.now());
	     var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
	     $("h5").html("Reception start: "+time);

	     $.get("/receive", function(data) {
		$("#messageBox").html(data['message']);
		console.log('Received message: '+data['message']);

  	        var dt = new Date($.now());
	        var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
	        $("h5").html("Reception end: "+time);

	     });      
     }

     $('#recButton').click(doReceive());

     setInterval(doReceive, 5000);

  });
  </script>
	
	
<div id="page">
 <center>
 <h3> Long Range Messenger </h3>
 
 <i> You're connected to Raspberry Pi rpi-name </i>

 <div id="body">

  Type below your message (140 char max.):<br><br>

  <input id="messageToSend" type="text" name="messageToSend" maxlength="140" size="30"><br><br>

  <button id="traButton" >Transmit</button>
  <button id="recButton" >Receive</button>

  <br><br>Received message (auto-refresh every 5 secs):

  <h4 id="messageBox">Received message will be here </h4>

  Last reception check:
  <h5>Idle</h5>


 </div>
</div>
</body>
</html>
